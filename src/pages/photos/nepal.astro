---
import PageLayout from "@layouts/PageLayout.astro";
import Container from "@components/Container.astro";
import BackToPrev from "@components/BackToPrev.astro";
import { getCountryPhotos } from "@data/photos";
import "@fancyapps/ui/dist/fancybox/fancybox.css";

const country = getCountryPhotos("nepal");
if (!country) return Astro.redirect("/photos");
---

<PageLayout title={`${country.name} Photos`} description={`Photos from ${country.name}`}>
  <Container>
    <div class="animate">
      <BackToPrev href="/photos">
        Back to photos
      </BackToPrev>
    </div>
    <div class="my-10">
      <h1 class="animate text-4xl font-display font-semibold text-black dark:text-white">{country.name}</h1>
    </div>
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 items-center country-photo-grid">
      {country.photos.map((photo, index) => (
        <a
          href={photo.src}
          data-fancybox="gallery"
          class="animate overflow-hidden block cursor-pointer"
          data-index={index}
        >
          <img
            src={photo.src}
            alt={photo.alt}
            loading={index < 6 ? "eager" : "lazy"}
            decoding="async"
            class="w-full h-auto hover:scale-105 transition-transform duration-300"
          />
        </a>
      ))}
    </div>
  </Container>
</PageLayout>

<style>
  .country-photo-grid {
    overflow: hidden;
  }

  .country-photo-grid a {
    max-width: 100%;
  }

  @media (min-width: 1024px) {
    .country-photo-grid a:nth-last-child(1):nth-child(3n-1) {
      grid-column: span 2;
    }
    .country-photo-grid a:nth-last-child(2):nth-child(3n-1) {
      grid-column: span 2;
    }
    .country-photo-grid a:nth-last-child(1):nth-child(3n-2) {
      grid-column: span 3;
    }
  }

  @media (min-width: 768px) and (max-width: 1023px) {
    .country-photo-grid a:nth-last-child(1):nth-child(odd) {
      grid-column: span 2;
    }
  }
</style>

<script>
  import { Fancybox } from "@fancyapps/ui";

  Fancybox.bind("[data-fancybox]", {
    theme: "auto",
    Carousel: {
      transition: "slide",
    },
  });
</script>
